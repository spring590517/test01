<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Type A / Type B 性格檢核量表</title>
  <meta name="description" content="以五點量表檢測你偏向 Type A 或 Type B，並產出可列印的檢測結果報告書。" />
  <style>
    :root{
      --maxw: 920px;
      --radius: 14px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:-apple-system,BlinkMacSystemFont,"Noto Sans TC","PingFang TC","Microsoft JhengHei",Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      line-height:1.6;
      color:#111827;
      background:#f7fafc;
    }
    header{
      background:linear-gradient(135deg,#eef2ff,#ecfeff);
      border-bottom:1px solid #e5e7eb;
    }
    .wrap{max-width:var(--maxw);margin:auto;padding:24px}
    h1{margin:.2em 0 .2em;font-size:clamp(22px,2.6vw,32px)}
    .sub{color:#374151;margin:.2em 0 1em}
    .card{
      background:#fff;border:1px solid #e5e7eb;border-radius:var(--radius);
      padding:20px; box-shadow:0 6px 20px rgba(0,0,0,.04);
    }
    .hero-list{margin:0;padding-left:18px}
    .hero-list li{margin:.25rem 0}
    .muted{color:#6b7280}
    .badge{
      display:inline-block;border:1px solid #d1d5db;background:#f9fafb;color:#374151;
      padding:.1rem .5rem;border-radius:999px;font-size:.8rem;margin-left:.4rem
    }
    .q{
      padding:16px; border:1px solid #eef2f7; border-radius:12px; margin-bottom:14px;
      background:#fbfdff;
    }
    .q h3{margin:0 0 .25rem; font-size:1.02rem}
    .scale{
      display:grid; grid-template-columns:repeat(5,minmax(0,1fr)); gap:8px; margin-top:10px;
    }
    .option{
      border:1px solid #e5e7eb; border-radius:10px; padding:10px; text-align:center;
      cursor:pointer; background:#fff;
    }
    input[type="radio"]{display:none}
    input[type="radio"]:checked + .option{
      border-color:#6366f1; box-shadow:0 0 0 3px rgba(99,102,241,.15);
    }
    .legend{display:flex; justify-content:space-between; font-size:.9rem; color:#6b7280; margin-top:6px}
    .actions{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px}
    button{
      appearance:none; border:0; border-radius:12px; padding:12px 16px; cursor:pointer;
      background:#111827; color:#fff; font-weight:600;
    }
    button.secondary{background:#fff; color:#111827; border:1px solid #e5e7eb}
    button.ghost{background:transparent; color:#374151; border:1px dashed #cbd5e1}
    .result{
      display:none; margin-top:18px
    }
    .result.show{display:block}
    .pill{
      display:inline-flex; align-items:center; gap:8px; padding:8px 10px; border-radius:999px;
      border:1px solid #e5e7eb; background:#fff; color:#111827; font-weight:600;
    }
    .grid-2{display:grid; grid-template-columns:1fr; gap:14px}
    @media(min-width:860px){.grid-2{grid-template-columns:1.2fr .8fr}}
    .kvs{display:grid; grid-template-columns:1fr 1fr; gap:8px}
    .kv{background:#f9fafb; border:1px solid #e5e7eb; border-radius:12px; padding:12px}
    .kv .k{font-size:.85rem; color:#6b7280}
    .kv .v{font-weight:700}
    footer{color:#9ca3af; font-size:.85rem; text-align:center; padding:24px}
    .small{font-size:.9rem}
    .section-title{margin:.2rem 0 .6rem;font-size:1.05rem}
    .hr{height:1px; background:#e5e7eb; margin:12px 0}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>Type A / Type B 性格檢核量表（五點）</h1>
      <p class="sub">完成下列 10 題，立刻得到你的傾向分數與一份<strong>檢測結果報告書</strong>（可列印/存 PDF）。<span class="badge">自我覺察工具 · 非醫療診斷</span></p>
      <div class="card">
        <h2 style="margin:.2rem 0">使用指導</h2>
        <ul class="hero-list">
          <li>依照你「平常的狀態」作答，直覺即可；不要只看最近一天。</li>
          <li>每題 1–5 分：1=非常不同意，3=普通/有時，5=非常同意。</li>
          <li>總分範圍 10–50 分：越高越偏向 Type A；越低越偏向 Type B。</li>
          <li>作答約 2 分鐘內完成。完成後可<span class="badge">一鍵列印/存 PDF</span>或<span class="badge">重新作答</span>。</li>
        </ul>
        <p class="muted small">健康提醒：Type A 往往高成就同時高壓；Type B 相對從容。沒有好壞之分，了解傾向只是為了更好地調整步調與能量。</p>
      </div>
    </div>
  </header>

  <main class="wrap">
    <form id="form" class="card" aria-labelledby="formTitle">
      <h2 id="formTitle" style="margin-top:.2rem">量表題目（請逐題選擇 1–5 分）</h2>

      <div id="questions"></div>

      <div class="actions">
        <button type="submit" id="submitBtn" aria-label="送出測驗並查看結果">送出並查看結果</button>
        <button type="button" class="secondary" id="resetBtn" aria-label="清除所有作答並重新開始">清除重填</button>
        <button type="button" class="ghost" id="saveBtn" aria-label="把作答暫存於此裝置">暫存作答</button>
        <button type="button" class="ghost" id="loadBtn" aria-label="讀取上次暫存">讀取暫存</button>
      </div>

      <div id="warn" class="muted small" role="alert" style="margin-top:8px; display:none">
        還有題目未作答，請完成所有題目後再送出。
      </div>

      <div id="result" class="result">
        <div class="hr"></div>
        <div class="grid-2">
          <section class="card" style="padding:16px">
            <h3 class="section-title">檢測結果報告書</h3>
            <div class="kvs">
              <div class="kv">
                <div class="k">總分（10–50）</div>
                <div class="v" id="score">—</div>
              </div>
              <div class="kv">
                <div class="k">傾向</div>
                <div class="v" id="band">—</div>
              </div>
            </div>

            <p id="summary" style="margin-top:10px"></p>

            <h4 class="section-title">你的傾向解讀</h4>
            <ul id="insights" class="hero-list" style="margin-bottom:0"></ul>

            <div style="margin-top:10px">
              <span class="pill" id="pillA">Type A 指標：—</span>
              <span class="pill" id="pillB" style="margin-left:8px">Type B 指標：—</span>
            </div>
          </section>

          <aside class="card" style="padding:16px">
            <h3 class="section-title">調整與建議</h3>
            <div id="advice"></div>
            <div class="hr"></div>
            <div class="actions">
              <button type="button" onclick="window.print()">列印 / 存 PDF</button>
              <button type="button" class="secondary" id="copyBtn">複製重點</button>
            </div>
            <p class="muted small" style="margin:8px 0 0">提示：列印時只會輸出本報告內容，適合留存或分享。</p>
          </aside>
        </div>
      </div>
    </form>
  </main>

  <footer>
    <div class="wrap">
      <div>© <span id="year"></span> Type A / Type B 檢核 · MIT License · 前端單檔版</div>
    </div>
  </footer>

  <script>
    // === 量表題目（10 題） ===
    const items = [
      "我常覺得時間不夠用，總想加快速度完成事情。",
      "我的說話、走路或吃飯速度，通常比別人快。",
      "我習慣同時處理多件事，很少單一專注。",
      "當事情拖延或遇到阻礙，我會感到焦躁或生氣。",
      "我很在意與別人的比較，輸贏或成敗對我很重要。",
      "我的生活以工作與成就為核心，休閒或放鬆常被忽略。",
      "我會為自己設定很高的標準，未達成就容易焦慮。",
      "我不喜歡別人動作慢，會覺得被拖累。",
      "我很少花時間單純享受生活或放鬆。",
      "身邊的人常提醒我太拼、太緊繃。"
    ];

    // 將題目對應到面向（用於產出洞察）
    const facets = {
      "時間步調": [0,1],
      "多工傾向": [2],
      "情緒反應": [3,7],
      "競爭取向": [4],
      "成就導向": [5,6],
      "休閒平衡": [8],
      "他人回饋": [9]
    };

    const formEl = document.getElementById('form');
    const qWrap = document.getElementById('questions');
    const warn = document.getElementById('warn');
    const result = document.getElementById('result');
    const scoreEl = document.getElementById('score');
    const bandEl  = document.getElementById('band');
    const summary = document.getElementById('summary');
    const insights = document.getElementById('insights');
    const advice = document.getElementById('advice');
    const pillA = document.getElementById('pillA');
    const pillB = document.getElementById('pillB');
    const yearEl = document.getElementById('year');
    yearEl.textContent = new Date().getFullYear();

    // 動態產生題目 + 五點量表
    function renderQuestions(){
      qWrap.innerHTML = '';
      items.forEach((txt, idx) => {
        const qId = `q${idx+1}`;
        const q = document.createElement('div');
        q.className = 'q';
        q.innerHTML = `
          <h3><span class="badge">第 ${idx+1} 題</span> ${txt}</h3>
          <div class="legend"><span>1 非常不同意</span><span>5 非常同意</span></div>
          <div class="scale" role="radiogroup" aria-label="第 ${idx+1} 題評分">
            ${[1,2,3,4,5].map(v => `
              <label>
                <input type="radio" name="${qId}" value="${v}" aria-label="${v}分">
                <div class="option">${v}</div>
              </label>
            `).join('')}
          </div>
        `;
        qWrap.appendChild(q);
      });
    }
    renderQuestions();

    function getValues(){
      const vals = [];
      for(let i=0;i<items.length;i++){
        const name = `q${i+1}`;
        const checked = formEl.querySelector(`input[name="${name}"]:checked`);
        vals.push(checked ? Number(checked.value) : null);
      }
      return vals;
    }

    function classify(total){
      // 10–24 Type B；25–39 混合；40–50 Type A
      if(total >= 40) return "明顯偏向 Type A";
      if(total >= 25) return "中間型（A/B 兼具）";
      return "明顯偏向 Type B";
    }

    function makeSummary(total){
      const band = classify(total);
      if(total >= 40){
        return "你展現高度的時間緊迫感、競爭與成就導向，效率很高，但也可能長期處於高壓狀態。建議刻意安排放鬆與恢復的節奏。";
      }else if(total >= 25){
        return "你同時具備 A/B 的彈性：在需要衝刺時能加速，也能在合適的情境放慢步調。若能針對壓力點做微調，會更穩。";
      }else{
        return "你整體從容、重視生活品質，情緒較穩。面對關鍵專案時，適度設定里程碑與強化行動節奏，能提升推進力。";
      }
    }

    function facetInsights(values){
      const out = [];
      Object.entries(facets).forEach(([facet, idxs]) => {
        const scores = idxs.map(i => values[i]).filter(Boolean);
        if(scores.length===0) return;
        const mean = scores.reduce((a,b)=>a+b,0)/scores.length;
        // 高於 3.6 視為偏 A；低於 2.4 視為偏 B；中間則平衡
        if(mean >= 3.6){
          out.push(`【${facet}】偏 A：平均約 ${mean.toFixed(1)} 分。`);
        }else if(mean <= 2.4){
          out.push(`【${facet}】偏 B：平均約 ${mean.toFixed(1)} 分。`);
        }else{
          out.push(`【${facet}】介於 A/B：平均約 ${mean.toFixed(1)} 分。`);
        }
      });
      return out;
    }

    function adviceText(total){
      if(total >= 40){
        return `
          <ul class="hero-list">
            <li>在行程中預設「不可動的恢復時段」（如睡眠、運動、散步）。</li>
            <li>把多工改成「短區段單工」：25–40 分鐘專注 + 5–10 分鐘休息。</li>
            <li>遇到延宕時，先用呼吸法把生理 arousal 拉低，再處理問題。</li>
            <li>把「贏過別人」換成「完成關鍵結果」的 KPI，降低無謂競逐。</li>
          </ul>
        `;
      }else if(total >= 25){
        return `
          <ul class="hero-list">
            <li>針對容易卡住的面向，設一個「最低可行行動」（MVA）每天推進。</li>
            <li>重要專案拉出節奏線（里程碑/截止日），避免臨時爆衝。</li>
            <li>定期自評壓力等級（1–10），>7 代表該降載或請求支援。</li>
          </ul>
        `;
      }else{
        return `
          <ul class="hero-list">
            <li>保持從容的同時，為重要任務加上「可交付的明確期限」。</li>
            <li>每週安排一次「高強度專注時段」，訓練啟動與衝刺能力。</li>
            <li>用「兩清單法」：日常維持清單 + 成就拉升清單，避免過度鬆散。</li>
          </ul>
        `;
      }
    }

    function countAB(values){
      // 4 分以上當作 A 指標；2 分以下當作 B 指標
      const a = values.filter(v => v>=4).length;
      const b = values.filter(v => v<=2).length;
      return {a,b};
    }

    function ensureComplete(vals){
      return vals.every(v => v !== null);
    }

    function saveProgress(vals){
      try{
        localStorage.setItem('typeAB_progress', JSON.stringify(vals));
      }catch(e){}
    }

    function loadProgress(){
      try{
        const raw = localStorage.getItem('typeAB_progress');
        if(!raw) return;
        const vals = JSON.parse(raw);
        vals.forEach((v,i)=>{
          if(v==null) return;
          const name = `q${i+1}`;
          const input = formEl.querySelector(`input[name="${name}"][value="${v}"]`);
          if(input){ input.checked = true; }
        });
      }catch(e){}
    }

    // 初始暫存載入
    loadProgress();

    // 事件：暫存 / 讀取 / 重置
    document.getElementById('saveBtn').addEventListener('click', ()=>{
      const vals = getValues();
      saveProgress(vals);
      alert('已暫存作答在此裝置。');
    });
    document.getElementById('loadBtn').addEventListener('click', ()=>{
      loadProgress();
      alert('已嘗試讀取暫存。');
    });
    document.getElementById('resetBtn').addEventListener('click', ()=>{
      formEl.reset();
      result.classList.remove('show');
      warn.style.display='none';
    });

    // 事件：複製重點
    document.getElementById('copyBtn').addEventListener('click', async ()=>{
      const txt = document.getElementById('summary').textContent.trim();
      try{
        await navigator.clipboard.writeText(`【Type A / B 檢測摘要】\n分數：${scoreEl.textContent}\n傾向：${bandEl.textContent}\n重點：${txt}`);
        alert('已複製檢測摘要到剪貼簿。');
      }catch(e){
        alert('複製失敗，請手動選取文字複製。');
      }
    });

    // 送出與計分
    formEl.addEventListener('submit', (e)=>{
      e.preventDefault();
      const values = getValues();
      if(!ensureComplete(values)){
        warn.style.display = 'block';
        result.classList.remove('show');
        return;
      }
      warn.style.display = 'none';

      const total = values.reduce((a,b)=>a+b,0);
      const band = classify(total);
      const insightList = facetInsights(values);
      const {a,b} = countAB(values);

      scoreEl.textContent = total;
      bandEl.textContent = band;
      summary.textContent = makeSummary(total);
      insights.innerHTML = insightList.map(s=>`<li>${s}</li>`).join('');
      advice.innerHTML = adviceText(total);
      pillA.textContent = `Type A 指標：${a} / 10 題（≥4 分）`;
      pillB.textContent = `Type B 指標：${b} / 10 題（≤2 分）`;

      result.classList.add('show');
      // 自動捲動到結果
      result.scrollIntoView({behavior:'smooth', block:'start'});
    });

    // 列印版樣式（只輸出報告區）
    const printCSS = `
      @media print{
        header, .actions:not(.keep), #warn, #questions, #saveBtn, #loadBtn, #resetBtn { display:none !important; }
        main .card{ box-shadow:none; border:0 }
        body{ background:#fff }
        .result{ display:block !important }
      }
    `;
    const styleNode = document.createElement('style');
    styleNode.textContent = printCSS;
    document.head.appendChild(styleNode);
  </script>
</body>
</html>
